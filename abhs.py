import telebot
from telebot import types
import time

bot = telebot.TeleBot('8270435189:AAHlHBvGdVbJ6bVBgj0B9bporeUj9XNIi9M')



@bot.message_handler(commands=['start'])
def start(message):
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add("üß© –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏")
    markup.add("üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è")
    markup.add("üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞ / –ü–æ–º–æ—â—å")

    try:
        with open("photo.jpg", "rb") as file:
            bot.send_photo(message.chat.id, file)
    except FileNotFoundError:
        bot.send_message(message.chat.id, "‚ö† –§–æ—Ç–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –Ω–æ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç.")
    bot.send_message(
        message.chat.id,
        "–ù–∞—à Telegram-–±–æ—Ç ‚Äî —ç—Ç–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è ¬´–£–º–Ω–æ–π —é—Ä—Ç–æ–π¬ª, —Å–æ–∑–¥–∞–Ω–Ω–∞—è —É—á–µ–Ω–∏–∫–∞–º–∏ CAP Education. –û–Ω –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–µ –∂–∏–ª–∏—â–µ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç —É –æ–±—ã—á–Ω—ã—Ö —É–º–Ω—ã—Ö –¥–æ–º–æ–≤. –ß–µ—Ä–µ–∑ –±–æ—Ç–∞ –º–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –æ—Å–≤–µ—â–µ–Ω–∏–µ–º, –∫–ª–∏–º–∞—Ç–æ–º, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ–≥–æ–¥–µ, –≤–µ—Ç—Ä–µ, —É—Ä–æ–≤–Ω–µ —ç–Ω–µ—Ä–≥–∏–∏ –∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –≤–æ–∫—Ä—É–≥ —é—Ä—Ç—ã. –ë–æ—Ç —Ç–∞–∫–∂–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Ç–∞–∫–∏–µ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã, –∫–∞–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —é—Ä—Ç—ã –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º –≤–µ—Ç—Ä–µ, ¬´—É–º–Ω–∞—è —Ç—é—Ä–µ¬ª, –∑–∞—â–∏—Ç–∞ –æ—Ç –¥–∏–∫–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö, CO-—Å–µ–Ω—Å–æ—Ä—ã –∏ –¥–∞–∂–µ GPS-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —é—Ä—Ç—É –±–µ–∑–æ–ø–∞—Å–Ω–æ–π, –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π.",
        reply_markup=markup
    )


@bot.message_handler(func=lambda m: m.text == "üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞ / –ü–æ–º–æ—â—å")
def support_menu(message):
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    kb.add("üì© –°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏", "üö® –°–æ–æ–±—â–∏—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–µ")
    kb.add("‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã", "‚¨Ö –ù–∞–∑–∞–¥")
    bot.send_message(
        message.chat.id,
        "üÜò *–ú–µ–Ω—é –ø–æ–º–æ—â–∏ –∏ —Å–≤—è–∑–∏*\n\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",
        parse_mode="Markdown",
        reply_markup=kb
    )


@bot.message_handler(commands=['help'])
def help_command(message):
    bot.send_message(
        message.chat.id,
        "üì© *–ü–æ–º–æ—â—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞*\n"
        "üìß ali.seyfolla@bk.ru\n"
        "üí¨ Telegram: @a1ix_fixz\n\n"
        "–ò–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ /report",
        parse_mode="Markdown"
    )


# ======================================================
# üìÆ –û–¢–ü–†–ê–í–ö–ê –û–ë–†–ê–©–ï–ù–ò–Ø /report
# ======================================================
@bot.message_handler(func=lambda m: m.text == "üö® –°–æ–æ–±—â–∏—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–µ")
@bot.message_handler(commands=['report'])
def report_start(message):
    bot.send_message(message.chat.id, "üìù –û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º ‚Äî —è –ø–µ—Ä–µ–¥–∞–º –µ—ë —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º.")
    bot.register_next_step_handler(message, forward_report)


def forward_report(message):
    text = f"‚ö†Ô∏è –û–ë–†–ê–©–ï–ù–ò–ï!\nüë§ @{message.from_user.username}\nüì©:\n{message.text}"
    bot.send_message(1338827765,text)
    bot.send_message(message.chat.id, "‚úî –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ! –°–ø–∞—Å–∏–±–æ üôå")


@bot.message_handler(func=lambda m: m.text == "üì© –°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏")
def contact_support(message):
    bot.send_message(
        message.chat.id,
        "üì® –ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ. –ú—ã –ø–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è –ø–æ–º–æ—á—å!"
    )
    bot.register_next_step_handler(message, forward_report)


@bot.message_handler(func=lambda m: m.text == "‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã")
def faq(message):
    bot.send_message(
        message.chat.id,
        "‚ùì *–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã*\n\n"
        "‚Ä¢ –§—É–Ω–∫—Ü–∏—è –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç—Å—è ‚Üí –µ—ë –Ω–∞–¥–æ –≤—ã–±—Ä–∞—Ç—å –≤ –º–µ–Ω—é.\n"
        "‚Ä¢ –ù–µ –≤—ã–∫–ª—é—á–∞–µ—Ç—Å—è ‚Üí –æ–Ω–∞ –µ—â—ë –Ω–µ –≤–∫–ª—é—á–µ–Ω–∞.\n"
        "‚Ä¢ –ß—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫? ‚Üí –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º /report\n\n"
        "üì© –ú—ã –Ω–∞ —Å–≤—è–∑–∏.",
        parse_mode="Markdown"
    )

def forward_report(message):
    username = message.from_user.username
    username = f"@{username}" if username else "üö´ Username –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"

    text = (
        f"üîî –ù–æ–≤–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ!\n"
        f"üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {username}\n"
        f"üÜî ID: {message.from_user.id}\n"
        f"üí¨ –°–æ–æ–±—â–µ–Ω–∏–µ:\n{message.text}"
    )

    bot.send_message(1338827765, text)
    bot.send_message(message.chat.id, "‚úî –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ! –°–ø–∞—Å–∏–±–æ üôå")

@bot.message_handler(func=lambda m: m.text == "üß© –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏")
def functions(message):
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    kb.add("üõ° –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "üå° –ö–ª–∏–º–∞—Ç")
    kb.add("‚ö° –≠–Ω–µ—Ä–≥–∏—è", "üìç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥")
    kb.add("ü™ë –ò–Ω—Ç–µ—Ä—å–µ—Ä –∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ")
    kb.add("‚¨Ö –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é")
    bot.send_message(message.chat.id, "üì¶ –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:", reply_markup=kb)


# ======================================================
# üõ° –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨
# ======================================================
@bot.message_handler(func=lambda m: m.text == "üõ° –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å")
def menu_security(message):
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    kb.add("ü™¢ –ê–≤—Ç–æ-—É–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —é—Ä—Ç—ã", "ü¶ä –ó–∞—â–∏—Ç–∞ –æ—Ç –∂–∏–≤–æ—Ç–Ω—ã—Ö")
    kb.add("üö® –°–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏—è", "üé• –ö–∞–º–µ—Ä–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è")
    kb.add("‚¨Ö –ù–∞–∑–∞–¥")
    bot.send_message(message.chat.id, "üõ° –°–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:", reply_markup=kb)


# ======================================================
# üå° –ö–õ–ò–ú–ê–¢
# ======================================================
@bot.message_handler(func=lambda m: m.text == "üå° –ö–ª–∏–º–∞—Ç")
def menu_climate(message):
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    kb.add("üéõ –£–º–Ω–∞—è —Ç—é—Ä–µ", "üî• –û—Ç–æ–ø–ª–µ–Ω–∏–µ")
    kb.add("üí® –í–µ–Ω—Ç–∏–ª—è—Ü–∏—è", "üíß –ö–æ–Ω—Ç—Ä–æ–ª—å –≤–ª–∞–∂–Ω–æ—Å—Ç–∏")
    kb.add("‚¨Ö –ù–∞–∑–∞–¥")
    bot.send_message(message.chat.id, "üå° –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–ª–∏–º–∞—Ç–∞:", reply_markup=kb)


# ======================================================
# ‚ö° –≠–ù–ï–†–ì–ò–Ø
# ======================================================
@bot.message_handler(func=lambda m: m.text == "‚ö° –≠–Ω–µ—Ä–≥–∏—è")
def menu_energy(message):
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    kb.add("‚ö° –≠–Ω–µ—Ä–≥–æ-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç", "üîã –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã")
    kb.add("‚òÄ –°–æ–ª–Ω–µ—á–Ω—ã–µ –ø–∞–Ω–µ–ª–∏", "üí° –û—Å–≤–µ—â–µ–Ω–∏–µ")
    kb.add("‚¨Ö –ù–∞–∑–∞–¥")
    bot.send_message(message.chat.id, "‚ö° –≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞:", reply_markup=kb)


# ======================================================
# üìç –ú–û–ù–ò–¢–û–†–ò–ù–ì
# ======================================================
@bot.message_handler(func=lambda m: m.text == "üìç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥")
def menu_monitoring(message):
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    kb.add("üõ∞ GPS-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥", "üìç –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —é—Ä—Ç—ã")
    kb.add("üå™ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –≤–µ—Ç—Ä–µ", "üêæ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è —Å–Ω–∞—Ä—É–∂–∏")
    kb.add("‚¨Ö –ù–∞–∑–∞–¥")
    bot.send_message(message.chat.id, "üìç –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:", reply_markup=kb)


# ======================================================
# ü™ë –ò–ù–¢–ï–†–¨–ï–†
# ======================================================
@bot.message_handler(func=lambda m: m.text == "ü™ë –ò–Ω—Ç–µ—Ä—å–µ—Ä –∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ")
def menu_interior(message):
    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    kb.add("ü™ë –°—Ö–µ–º–∞ –º–µ–±–µ–ª–∏", "üìê –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞")
    kb.add("‚¨Ö –ù–∞–∑–∞–¥")
    bot.send_message(message.chat.id, "ü™ë –ü–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ —é—Ä—Ç—ã:", reply_markup=kb)


# ======================================================
# üìù –û–ü–ò–°–ê–ù–ò–Ø –§–£–ù–ö–¶–ò–ô
# ======================================================
feature_descriptions = {
    "ü™¢ –ê–≤—Ç–æ-—É–∫—Ä–µ–ø–ª–µ–Ω–∏–µ —é—Ä—Ç—ã": "–£–∫—Ä–µ–ø–ª–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º –≤–µ—Ç—Ä–µ (>20 –º/—Å).",
    "ü¶ä –ó–∞—â–∏—Ç–∞ –æ—Ç –∂–∏–≤–æ—Ç–Ω—ã—Ö": "–î–∞—Ç—á–∏–∫–∏ + —Å–≤–µ—Ç/–∑–≤—É–∫ –æ—Ç–ø—É–≥–∏–≤–∞–Ω–∏—è –∂–∏–≤–Ω–æ—Å—Ç–∏.",
    "üö® –°–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏—è": "–§–∏–∫—Å–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è, —Ç—Ä–µ–≤–æ–∂–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.",
    "üé• –ö–∞–º–µ—Ä–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è": "–§–æ—Ç–æ/–≤–∏–¥–µ–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –∫–∞–º–µ—Ä–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞).",
    "üéõ –£–º–Ω–∞—è —Ç—é—Ä–µ": "–†–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ –æ—Ç–≤–µ—Ä—Å—Ç–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ–≥–æ–¥—ã.",
    "üî• –û—Ç–æ–ø–ª–µ–Ω–∏–µ": "–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–µ—á–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.",
    "üí® –í–µ–Ω—Ç–∏–ª—è—Ü–∏—è": "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏–µ.",
    "üíß –ö–æ–Ω—Ç—Ä–æ–ª—å –≤–ª–∞–∂–Ω–æ—Å—Ç–∏": "–ó–∞—â–∏—Ç–∞ –æ—Ç —Å—ã—Ä–æ—Å—Ç–∏ –∏ –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–∞.",
    "‚ö° –≠–Ω–µ—Ä–≥–æ-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç": "–≠–∫–æ–Ω–æ–º–∏—è —ç–Ω–µ—Ä–≥–∏–∏ –∏ –±–∞–ª–∞–Ω—Å –Ω–∞–≥—Ä—É–∑–∫–∏.",
    "üîã –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã": "–°—Ç–∞—Ç—É—Å –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∏—Ç–∞–Ω–∏—è.",
    "‚òÄ –°–æ–ª–Ω–µ—á–Ω—ã–µ –ø–∞–Ω–µ–ª–∏": "–ö–æ–Ω—Ç—Ä–æ–ª—å —Ä–∞–±–æ—Ç—ã —Å–æ–ª–Ω–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.",
    "üí° –û—Å–≤–µ—â–µ–Ω–∏–µ": "–£–ª–∏—á–Ω–æ–µ/–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ.",
    "üõ∞ GPS-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥": "–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —é—Ä—Ç—ã.",
    "üìç –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —é—Ä—Ç—ã": "–ü–æ–ª—É—á–µ–Ω–∏–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏.",
    "üå™ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –≤–µ—Ç—Ä–µ": "–î–∞–Ω–Ω—ã–µ –ø–æ—Ä—ã–≤–æ–≤ + —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.",
    "üêæ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è —Å–Ω–∞—Ä—É–∂–∏": "–ö–æ–Ω—Ç—Ä–æ–ª—å –ø–µ—Ä–∏–º–µ—Ç—Ä–∞.",
    "ü™ë –°—Ö–µ–º–∞ –º–µ–±–µ–ª–∏": "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.",
    "üìê –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞": "–ü–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å."
}


@bot.message_handler(func=lambda msg: msg.text in feature_descriptions)
def function_info(message):
    chat_id = message.chat.id
    feature = message.text

    if not hasattr(bot, "user_state"):
        bot.user_state = {}
    bot.user_state[chat_id] = {"feature": feature, "active": False}

    bot.send_message(chat_id, f"üìç *{feature}*\n\nüìù {feature_descriptions[feature]}", parse_mode="Markdown")

    kb = types.ReplyKeyboardMarkup(resize_keyboard=True)
    kb.add("‚ñ∂ –í–∫–ª—é—á–∏—Ç—å", "‚õî –í—ã–∫–ª—é—á–∏—Ç—å")
    kb.add("‚¨Ö –ù–∞–∑–∞–¥")
    bot.send_message(chat_id, "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:", reply_markup=kb)


# ======================================================
# ‚ñ∂ –í–ö–õ / ‚õî –í–´–ö–õ –° –ü–†–û–í–ï–†–ö–û–ô
# ======================================================
@bot.message_handler(func=lambda m: m.text == "‚ñ∂ –í–∫–ª—é—á–∏—Ç—å")
def turn_on(message):
    chat_id = message.chat.id
    state = bot.user_state.get(chat_id)
    if not state:
        return bot.send_message(chat_id, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é.")

    feature = state["feature"]
    bot.send_message(chat_id, "‚öô –ó–∞–ø—É—Å–∫ —Ñ—É–Ω–∫—Ü–∏–∏...")
    time.sleep(1)
    bot.user_state[chat_id]["active"] = True
    bot.send_message(chat_id, f"‚ñ∂ {feature} –≤–∫–ª—é—á–µ–Ω–∞.\n‚úî –°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞.")


@bot.message_handler(func=lambda m: m.text == "‚õî –í—ã–∫–ª—é—á–∏—Ç—å")
def turn_off(message):
    chat_id = message.chat.id
    state = bot.user_state.get(chat_id)
    if not state:
        return bot.send_message(chat_id, "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é.")

    feature = state["feature"]
    if not state["active"]:
        return bot.send_message(
            chat_id,
            "‚ùó–§—É–Ω–∫—Ü–∏—è –µ—â—ë –Ω–µ –±—ã–ª–∞ –∑–∞–ø—É—â–µ–Ω–∞.\n‚ñ∂ –°–Ω–∞—á–∞–ª–∞ –≤–∫–ª—é—á–∏—Ç–µ –µ—ë.",
            parse_mode="Markdown"
        )

    bot.send_message(chat_id, "üîª –û—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã...")
    time.sleep(1)
    bot.user_state[chat_id]["active"] = False
    bot.send_message(chat_id, f"‚õî {feature} –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.\nüîå –°–∏—Å—Ç–µ–º–∞ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º —Ä–µ–∂–∏–º–µ.")


# ======================================================
# üìñ –ò–ù–°–¢–†–£–ö–¶–ò–Ø
# ======================================================
@bot.message_handler(func=lambda m: m.text == "üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è")
def instruction(message):
    bot.send_message(
        message.chat.id,
        "üìò *–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º:*\n"
        "1. –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é\n"
        "2. –í—ã–±–µ—Ä–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É\n"
        "3. –í–∫–ª—é—á–∏—Ç–µ –∏–ª–∏ –≤—ã–∫–ª—é—á–∏—Ç–µ\n"
        "4. –î–ª—è —Å–≤—è–∑–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞ / –ü–æ–º–æ—â—å",
        parse_mode="Markdown"
    )



@bot.message_handler(func=lambda m: m.text == "‚¨Ö –ù–∞–∑–∞–¥")
def back(message):
    functions(message)


@bot.message_handler(func=lambda m: m.text == "‚¨Ö –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é")
def main_menu(message):
    start(message)


bot.polling(none_stop=True)
